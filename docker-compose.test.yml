services:
    app:
        image: app:latest
        build:
            context: .
            target: app

    test-e2e:
        image: test-e2e:latest
        build:
            context: .
            target: test-e2e
        environment:
            API_URL: http://app:8080
        depends_on:
            app:
                condition: service_healthy

    test-unit:
        image: test-unit:latest
        volumes:
            - ./coverage:/app/coverage
        build:
            context: .
            target: test-unit
